<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹å¯«æ¿</title>
	<link rel="icon" type="image/svg+xml" href="https://ymdd-image-tw.s3.ap-east-2.amazonaws.com/image/paintbrush-solid-full.svg">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script> 
    <style>
        /* --- CSS æ¨£å¼ --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background-color: #f4f7f9;
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
        }
        .controls {
            margin-bottom: 15px; 
            display: flex;
            flex-direction: column;
            gap: 10px; 
        }
        
        /* å€å¡Š 1 & 2 åˆä½µï¼šå·¥å…·èˆ‡æ¨£å¼æ§åˆ¶ */
        .tool-and-style-controls { 
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 8px 10px; 
            background-color: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            flex-wrap: wrap; 
        }

        /* å¯¦ç”¨åŠŸèƒ½åˆ—å®¹å™¨ */
        .utility-options {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            flex-wrap: wrap; 
        }
        
        /* åœ–ç¤ºå·¥å…·æŒ‰éˆ•æ¨£å¼ (V37.1 èª¿æ•´ font-size) */
        .tool-and-style-controls button[data-mode] {
            padding: 8px 10px; 
            min-width: 40px; 
            cursor: pointer;
            border: 1px solid #007bff;
            border-radius: 4px;
            background-color: #f0f8ff;
            color: #007bff;
            font-size: 18px; /* æé«˜å­—é«”å¤§å°ï¼Œç¢ºä¿ SVG æ¸…æ¥š */
            transition: all 0.2s;
            white-space: nowrap;
        }
        .tool-and-style-controls button[data-mode].active {
            background-color: #007bff;
            color: white;
            border-color: #0056b3;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }
        /* ç¢ºä¿ Font Awesome åœ–ç¤ºèƒ½è¢«æ­£ç¢ºè‘—è‰²å’Œç¸®æ”¾ */
        .tool-and-style-controls button i {
            color: inherit; /* ç¹¼æ‰¿æŒ‰éˆ•é¡è‰² */
        }


        /* é¡è‰²è¼¸å…¥ã€ç·šå¯¬æ»‘æ¡¿ */
        .tool-and-style-controls input[type="range"] {
            width: 70px; 
            margin-right: 5px;
        }
        
        /* é¡è‰²é¸å–®æŒ‰éˆ• */
        .color-palette-btn {
            width: 25px; 
            height: 25px;
            border-radius: 50%;
            border: 2px solid #ccc;
            cursor: pointer;
            transition: border-color 0.2s;
            padding: 0;
            margin: 0 1px;
            opacity: 0.9;
            box-sizing: content-box;
            background-color: currentColor; 
        }

        /* å¯¦ç”¨åŠŸèƒ½æŒ‰éˆ•é€šç”¨æ¨£å¼ (V37.1 èª¿æ•´å­—é«”å¤§å°) */
        .utility-options > button:not(#resize-canvas-btn):not(#save-image-btn), 
        .utility-options > label[for="background-image-input"] {
            padding: 8px 15px;
            cursor: pointer;
            border: 1px solid #007bff;
            border-radius: 4px;
            background-color: #f0f8ff;
            color: #007bff;
            font-weight: 600;
            font-size: 14px; /* è®“å­—é«”æ›´é©åˆæŒ‰éˆ• */
            transition: all 0.2s;
            white-space: nowrap;
        }

        /* ç‰¹æ®ŠåŠŸèƒ½æŒ‰éˆ•æ¨£å¼ */
        #save-image-btn { 
            padding: 8px 15px;
            cursor: pointer;
            border: 1px solid #17a2b8;
            border-radius: 4px; 
            background-color: #17a2b8; 
            color: white; 
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
        }
        #resize-canvas-btn { 
            padding: 8px 15px;
            cursor: pointer;
            border: 1px solid #28a745; 
            border-radius: 4px;
            background-color: #28a745; 
            color: white; 
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        /* å°ºå¯¸èª¿æ•´æ§åˆ¶é …çš„ Flex æ¨£å¼ */
        #size-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            padding-left: 0; 
            margin-left: 0; 
            flex-wrap: wrap; 
        }
        
        #size-controls label {
            padding: 0;
            cursor: default;
            border: none;
            background-color: transparent;
            color: #333;
            font-weight: 600;
            white-space: nowrap;
            font-size: 14px;
        }
        #size-controls input[type="number"] {
            width: 70px; 
            padding: 5px; 
            border: 1px solid #ccc; 
            border-radius: 4px;
            font-size: 14px;
        }
        
        /* ç•«å¸ƒå®¹å™¨æ¨£å¼ */
        #canvas-container {
            width: 900px;
            height: 600px;
            border: 1px solid #ccc;
            background-color: #ffffff; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain; 
            position: relative; 
        }

        #c {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>

    <h2>ğŸ› ï¸ ç¶²é äº’å‹•ç•«æ¿</h2>

    <div class="controls">
        
        <h3>ç•¶å‰å·¥å…·: <span id="current-tool-display" style="color: #007bff; font-weight: bold;">(ç­†åˆ·)</span></h3>
        
        <div class="tool-and-style-controls">
            <button id="brush-mode-btn" data-mode="brush" class="active" title="ç­†åˆ·">
                <i class="fa-solid fa-paintbrush"></i>
            </button>
            <button id="highlighter-mode-btn" data-mode="highlighter" title="è¢å…‰ç­†">
                <i class="fa-solid fa-highlighter"></i>
            </button>
            <button id="eraser-mode-btn" data-mode="eraser" title="æ©¡çš®æ“¦">
                <i class="fa-solid fa-eraser"></i>
            </button> 
            <button id="select-mode-btn" data-mode="select" title="é¸æ“‡/ç§»å‹•">
                <i class="fa-solid fa-up-down-left-right"></i>
            </button>
            
            <span style="border-left: 1px solid #eee; padding-left: 12px; font-weight: 600;"></span>
            
            <label for="drawing-color" style="font-weight: 600;">é¡è‰²:</label>
            <input type="color" id="drawing-color" value="#007bff">

            <label for="line-width" style="font-weight: 600; margin-left: 5px;">ç²—ç´°:</label>
            <input type="range" value="5" min="1" max="100" id="line-width">
            <span id="line-width-display" style="margin-right: 5px;">5</span>
            
            <span style="border-left: 1px solid #eee; padding-left: 12px; font-weight: 600;">ç­†åŠƒ:</span>
            <button class="color-palette-btn" data-target="brush" data-color="#007bff" style="background-color: #007bff;" title="è—è‰²ç­†åŠƒ"></button>
            <button class="color-palette-btn" data-target="brush" data-color="#000000" style="background-color: #000000;" title="é»‘è‰²ç­†åŠƒ"></button>
            
            <span style="border-left: 1px solid #eee; padding-left: 12px; font-weight: 600;">è¢å…‰:</span>
            <button class="color-palette-btn" data-target="highlighter" data-color="#ffff00" style="background-color: #ffff00;" title="é»ƒè‰²è¢å…‰ç­†"></button>
            <button class="color-palette-btn" data-target="highlighter" data-color="#79f2f2" style="background-color: #79f2f2;" title="è—è‰²è¢å…‰ç­†"></button>
        </div>

        <div class="utility-options">
            <button id="add-text-btn">ğŸ“ æ’å…¥æ–‡å­—æ–¹å¡Š</button>
            
            <label for="background-image-input">ğŸ–¼ï¸ å°å…¥åº•åœ–</label>
            <input type="file" id="background-image-input" accept="image/*" style="display: none;">
            <button id="clear-background-btn">ğŸ—‘ï¸ æ¸…é™¤åº•åœ–</button>
            <button id="clear-all-drawings-btn">ğŸ§¹ æ¸…é™¤ç­†è·¡</button>
            <button id="delete-selected-btn">âŒ åˆªé™¤é¸å–</button>
            
            <div id="size-controls">
                <label for="new-width">å¯¬åº¦ (px)ï¼š</label>
                <input type="number" id="new-width" value="900" min="300">
                <label for="new-height">é«˜åº¦ (px)ï¼š</label>
                <input type="number" id="new-height" value="600" min="300">
                <button id="resize-canvas-btn">ğŸ“ èª¿æ•´å°ºå¯¸</button>
            </div>
            
            <button id="save-image-btn">ğŸ’¾ å„²å­˜ç‚º PNG</button>
        </div>
        
    </div>

    <div id="canvas-container">
        <canvas id="c" width="900" height="600"></canvas>
    </div>


    <script>
        // *** JavaScript è…³æœ¬ä¿æŒ V36.0 é‚è¼¯ä¸è®Šï¼Œæ‰€æœ‰åŠŸèƒ½æ­£å¸¸é‹ä½œ ***
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- æ ¸å¿ƒè®Šæ•¸èˆ‡åˆå§‹åŒ– ---
            const initialWidth = 900;
            const initialHeight = 600;

            const canvas = new fabric.Canvas('c', { 
                isDrawingMode: false,
                preserveObjectStacking: true, 
                backgroundColor: 'transparent',
                width: initialWidth, 
                height: initialHeight
            });

            const pencilBrush = new fabric.PencilBrush(canvas);
            let brushSettings = {
                brush: { brush: pencilBrush, color: '#007bff', width: 5, composite: 'source-over' },
                highlighter: { brush: pencilBrush, color: '#ffff0080', width: 30, composite: 'source-over' }, 
                eraser: { 
                    brush: pencilBrush, 
                    color: 'rgba(150, 150, 150, 0.5)', 
                    width: 25, 
                    composite: 'source-over' 
                }, 
                select: { brush: pencilBrush, color: '#000000', width: 1, composite: 'source-over' }
            };
            let currentMode = 'brush'; 

            // --- DOM å…ƒç´ å¿«å– ---
            const canvasContainer = document.getElementById('canvas-container'); 
            const toolDisplay = document.getElementById('current-tool-display');
            const colorEl = document.getElementById('drawing-color');
            const widthRangeEl = document.getElementById('line-width');
            const widthDisplayEl = document.getElementById('line-width-display');
            const saveImageBtn = document.getElementById('save-image-btn'); 
            const newWidthEl = document.getElementById('new-width'); 
            const newHeightEl = document.getElementById('new-height'); 
            const resizeCanvasBtn = document.getElementById('resize-canvas-btn'); 
            
            // å…¶ä»–æŒ‰éˆ•å¿«å–
            const brushModeBtn = document.getElementById('brush-mode-btn');
            const highlighterModeBtn = document.getElementById('highlighter-mode-btn');
            const eraserModeBtn = document.getElementById('eraser-mode-btn');
            const selectModeBtn = document.getElementById('select-mode-btn');
            const deleteSelectedBtn = document.getElementById('delete-selected-btn');
            const bgImageInput = document.getElementById('background-image-input');
            const clearBgBtn = document.getElementById('clear-background-btn');
            const clearAllDrawingsBtn = document.getElementById('clear-all-drawings-btn');
            const addTextBtn = document.getElementById('add-text-btn');

            
            // ** æ©¡çš®æ“¦/æ–‡å­—å †ç–Šé‚è¼¯ **
            canvas.on('path:created', function(e) {
                const path = e.path;
                path.isEraserPath = (currentMode === 'eraser');
                
                if (currentMode === 'eraser') {
                    path.set({ 
                        globalCompositeOperation: 'destination-out',
                        selectable: false,
                        evented: false,
                        stroke: 'rgba(0,0,0,1)' 
                    }); 
                    
                    canvas.getObjects().forEach(obj => {
                        if (obj.type !== 'i-text') {
                            canvas.bringToFront(obj);
                        }
                    });
                    canvas.bringToFront(path);
                    
                } else {
                    path.set({ selectable: false, evented: false }); 
                    canvas.bringToFront(path);
                }
                
                canvas.getObjects().filter(obj => obj.type === 'i-text').forEach(textObj => {
                    canvas.bringToFront(textObj);
                });

                canvas.renderAll(); 
            });

            // é›™æ“Šæ–‡å­—é€²å…¥ç·¨è¼¯
            canvas.on('mouse:dblclick', function(options) {
                if (options.target && options.target.type === 'i-text') {
                    options.target.enterEditing();
                    canvas.renderAll();
                }
            });


            /**
             * æ ¸å¿ƒåŠŸèƒ½å‡½æ•¸ï¼šè¨­å®šå·¥å…·æ¨¡å¼
             */
            function setToolMode(mode) {
                currentMode = mode;
                
                toolDisplay.textContent = `(${mode.toUpperCase()})`;
                
                // ä¿®æ­£é¸æ“‡å™¨ä»¥åŒ¹é…æ–°çš„åˆä½µå€å¡Š
                document.querySelectorAll('.tool-and-style-controls button[data-mode]').forEach(btn => btn.classList.remove('active'));
                const activeBtn = document.querySelector(`[data-mode="${mode}"]`);
                if (activeBtn) {
                    activeBtn.classList.add('active');
                }
                
                if (mode === 'select') {
                    canvas.isDrawingMode = false;
                    canvas.selection = true;
                    canvas.forEachObject(obj => {
                        const isSelectable = (obj.type === 'i-text' || (obj.type === 'path' && obj.isEraserPath === false));
                        obj.set({ selectable: isSelectable, evented: isSelectable });
                    });
                    canvas.defaultCursor = 'default';
                    colorEl.disabled = true;
                    widthRangeEl.disabled = true;
                    return; 
                }
                
                canvas.isDrawingMode = true; 
                canvas.selection = false;
                canvas.forEachObject(obj => obj.set({ selectable: false, evented: false })); 
                colorEl.disabled = (mode === 'eraser');
                widthRangeEl.disabled = false;
                canvas.defaultCursor = (mode === 'eraser') ? 'crosshair' : 'default';

                const settings = brushSettings[mode];
                widthRangeEl.value = settings.width;
                widthDisplayEl.textContent = settings.width;
                
                canvas.freeDrawingBrush = settings.brush;
                settings.brush.width = settings.width;
                canvas.freeDrawingBrush.color = settings.color; 
                canvas.freeDrawingBrush.globalCompositeOperation = settings.composite;
                
                if (mode !== 'eraser') {
                    colorEl.value = settings.color.substring(0, 7); 
                }
            }
            
            // --- äº‹ä»¶ç›£è½å™¨ç¶å®š (ä¿æŒ V35.0 é‚è¼¯) ---
            brushModeBtn.addEventListener('click', () => setToolMode('brush'));
            highlighterModeBtn.addEventListener('click', () => setToolMode('highlighter'));
            eraserModeBtn.addEventListener('click', () => setToolMode('eraser'));
            selectModeBtn.addEventListener('click', () => setToolMode('select'));
            
            // ç¹ªåœ–è¨­å®š 
            document.getElementById('drawing-color').addEventListener('change', function() {
                if (currentMode === 'brush' || currentMode === 'highlighter') {
                    const newColor = this.value;
                    let finalColor = newColor;
                    if (currentMode === 'highlighter') {
                        finalColor = newColor + '80';
                    }
                    brushSettings[currentMode].color = finalColor;
                    canvas.freeDrawingBrush.color = finalColor; 
                }
            });

            document.getElementById('line-width').addEventListener('input', function() {
                const width = parseInt(this.value, 10) || 1;
                widthDisplayEl.textContent = width;
                brushSettings[currentMode].width = width;
                canvas.freeDrawingBrush.width = width;
            });

            document.querySelectorAll('.color-palette-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const target = this.dataset.target;
                    const newColor = this.dataset.color;
                    
                    // æ ¹æ“šé»æ“Šçš„æŒ‰éˆ•ç›®æ¨™ä¾†è¨­å®šæ¨¡å¼
                    if (target === 'highlighter') {
                        brushSettings.highlighter.color = newColor + '80';
                        brushSettings.highlighter.width = 30; // é è¨­è¢å…‰ç­†ç²—ä¸€é»
                        setToolMode('highlighter');
                    } else {
                        brushSettings.brush.color = newColor;
                        brushSettings.brush.width = 5; // é è¨­ç­†åˆ·ç´°ä¸€é»
                        setToolMode('brush');
                    }
                });
            });

            // å°å…¥/æ¸…é™¤åº•åœ– (DOM èƒŒæ™¯)
            bgImageInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = function(f) {
                    canvasContainer.style.backgroundImage = `url(${f.target.result})`;
                    canvas.backgroundColor = 'transparent';
                    canvas.renderAll(); 
                };
                reader.readAsDataURL(file);
            });

            clearBgBtn.addEventListener('click', function() {
                canvasContainer.style.backgroundImage = 'none';
                canvas.backgroundColor = '#ffffff'; 
                canvas.renderAll();
            });

            // æ¸…é™¤ç­†è·¡/æ–‡å­—
            clearAllDrawingsBtn.addEventListener('click', function() {
                const objectsToRemove = canvas.getObjects().filter(obj => 
                    (obj.type === 'path' || obj.type === 'i-text')
                );
                canvas.remove(...objectsToRemove);
                canvas.renderAll();
            });

            // æ’å…¥æ–‡å­—æ–¹å¡Š 
            addTextBtn.addEventListener('click', function() {
                setToolMode('select'); 
                const text = new fabric.IText('é»æ“Šè¼¸å…¥æ–‡å­—', { 
                    left: 50, top: 50, fontSize: 24, fill: '#333333', editable: true,
                });
                canvas.add(text);
                canvas.setActiveObject(text);
                canvas.bringToFront(text); 
                text.enterEditing(); 
                canvas.renderAll();
            });

            // åˆªé™¤é¸å–ç‰©ä»¶
            deleteSelectedBtn.addEventListener('click', function() {
                const activeObjects = canvas.getActiveObjects();
                if (activeObjects.length > 0) {
                    canvas.remove(...activeObjects);
                    canvas.discardActiveObject().renderAll();
                }
            });

            // éµç›¤åˆªé™¤
            document.addEventListener('keydown', (e) => {
                const activeObject = canvas.getActiveObject();
                if ((e.key === 'Delete' || e.key === 'Backspace') && activeObject && (!activeObject.isEditing || activeObject.type !== 'i-text')) {
                    deleteSelectedBtn.click();
                    e.preventDefault();
                }
            });
            
            // ** èª¿æ•´å°ºå¯¸åŠŸèƒ½é‚è¼¯ **
            resizeCanvasBtn.addEventListener('click', () => {
                const newWidth = parseInt(newWidthEl.value, 10);
                const newHeight = parseInt(newHeightEl.value, 10);

                if (newWidth >= 300 && newHeight >= 300) {
                    canvas.setDimensions({ width: newWidth, height: newHeight });
                    canvasContainer.style.width = `${newWidth}px`;
                    canvasContainer.style.height = `${newHeight}px`;

                    canvas.renderAll();
                } else {
                    alert("å¯¬åº¦å’Œé«˜åº¦å¿…é ˆç‚ºå¤§æ–¼ç­‰æ–¼ 300 çš„æ­£æ•´æ•¸ã€‚");
                }
            });


            // ** å„²å­˜åœ–ç‰‡åŠŸèƒ½æ ¸å¿ƒé‚è¼¯ **
            saveImageBtn.addEventListener('click', async function() { 
                if (typeof html2canvas === 'undefined') {
                    alert("éŒ¯èª¤: html2canvas åº«æœªè¼‰å…¥ï¼Œç„¡æ³•åŸ·è¡Œæˆªåœ–åŠŸèƒ½ã€‚");
                    return;
                }
                
                saveImageBtn.disabled = true;
                setToolMode('select'); 

                // 1. å„²å­˜åŸå§‹ç•«å¸ƒç‹€æ…‹
                const originalCanvasJSON = canvas.toJSON(['isEraserPath']);
                canvas.discardActiveObject(); 
                
                // 2. æ‰¾å‡ºéœ€è¦å›ºåŒ–çš„ç‰©ä»¶å’Œéœ€è¦ä¿ç•™çš„ç‰©ä»¶
                const nonTextObjects = canvas.getObjects().filter(obj => obj.type !== 'i-text');
                const textObjects = canvas.getObjects().filter(obj => obj.type === 'i-text');
                
                let snapshotImage = null;

                if (nonTextObjects.length > 0) {
                    // æš«æ™‚å°‡æ‰€æœ‰æ–‡å­—ç‰©ä»¶å¾ç•«å¸ƒä¸­ç§»é™¤
                    canvas.remove(...textObjects);
                    canvas.renderAll(); 

                    const drawingSnapshotURL = canvas.toDataURL({
                        format: 'png',
                        multiplier: 2 
                    });

                    // é‡æ–°å°‡æ–‡å­—ç‰©ä»¶åŠ å›ä¾†ï¼Œæº–å‚™æ¢å¾© (ç¢ºä¿ JSON æº–ç¢º)
                    canvas.add(...textObjects);
                    canvas.renderAll(); 

                    // 3. å°‡å¿«ç…§è½‰ç‚º fabric.Image ç‰©ä»¶
                    snapshotImage = await new Promise(resolve => {
                        fabric.Image.fromURL(drawingSnapshotURL, img => {
                            img.set({
                                left: 0, top: 0,
                                selectable: false, evented: false,
                                originX: 'left', originY: 'top',
                                scaleX: canvas.width / img.width,
                                scaleY: canvas.height / img.height
                            });
                            resolve(img);
                        });
                    });
                }
                
                // 4. æº–å‚™æˆªåœ–ç•«å¸ƒï¼šæ¸…ç©ºä¸¦åŠ å…¥å¿«ç…§å’Œæ–‡å­—
                canvas.clear(); 
                
                if (snapshotImage) {
                    canvas.add(snapshotImage);
                    canvas.sendToBack(snapshotImage); 
                }

                textObjects.forEach(text => {
                    canvas.add(text);
                    canvas.bringToFront(text);
                });
                
                canvas.renderAll(); 
                
                // 5. åŸ·è¡Œ html2canvas æˆªåœ–
                try {
                    const canvasShot = await html2canvas(canvasContainer, {
                        useCORS: true, 
                        scale: 2, 
                        logging: false 
                    });

                    // 6. å„²å­˜åœ–ç‰‡
                    const dataURL = canvasShot.toDataURL('image/png');
                    const link = document.createElement('a');
                    link.href = dataURL;
                    link.download = `drawing-${Date.now()}.png`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);

                } catch (error) {
                    alert("æˆªåœ–å¤±æ•—ã€‚è«‹ç¢ºèªç€è¦½å™¨æ”¯æ´æˆ–åœ–ç‰‡ä¾†æºæ˜¯å¦å…è¨±è·¨åŸŸå­˜å–ã€‚");
                    console.error("æˆªåœ–éŒ¯èª¤:", error);
                }

                // 7. æ¢å¾©åŸå§‹ç‹€æ…‹ï¼šä½¿ç”¨ JSON å®Œæ•´é‚„åŸ
                canvas.clear(); 
                canvas.loadFromJSON(originalCanvasJSON, () => {
                    canvas.renderAll();
                    saveImageBtn.disabled = false;
                });
            });


            // åˆå§‹è¼‰å…¥
            setToolMode('brush');
            canvasContainer.style.backgroundColor = '#ffffff'; 
            newWidthEl.value = initialWidth;
            newHeightEl.value = initialHeight;
            canvas.renderAll();
        });
    </script>

</body>
</html>
